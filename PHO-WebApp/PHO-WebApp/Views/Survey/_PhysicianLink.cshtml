@model PHO_WebApp.Models.Section
@{
    Layout = null;
}

@* Begin Physician Lookup *@

@if (Model.PhysicianLinkType == PHO_WebApp.Models.PhysicianLinkTypeEnum.Allowed
|| Model.PhysicianLinkType == PHO_WebApp.Models.PhysicianLinkTypeEnum.Required)
{

    @*<p>
        
    </p>*@
    <div class="row" style="margin-bottom:5px;">
        <div class="col">
            <div id="@("LinkPanel" + Model.SectionId)">
                <div class="card card-body">
                    <p>
                        <h5>Physician Link</h5>
                        <i>Requires a link to an existing practice physician. Select a physician below.</i>                        
                    </p>
                    <div class="input-group collapse show" id="@("LinkPanel" + Model.SectionId + "_Set")">
                        <label for="txtPhysician">Physician Lookup: </label>
                        <input type="text" id="txtPhysician" name="PhysicianName" style="font-style:italic" placeholder="Enter search term here" />
                        <div class="input-group-append">
                            <button class="btn btn-secondary" type="button">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                        <input type="hidden" id="hfPhysician" name="PhysicianId" />
                        @*@Html.HiddenFor(Model.Ph)*@
                    </div>
                    <div class="input-group collapse"  id="@("LinkPanel" + Model.SectionId + "_Display")">
                        <strong id="sectionPhysicianLink" style="font-weight:bold"></strong>&nbsp;
                        <a class="btn btn-primary" data-toggle="collapse" onclick="togglePhysicianLink()" href="#" role="button" aria-expanded="false" aria-controls="@("LinkPanel" + Model.SectionId)">Reset</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @*End Physician Lookup*@




    <script>
    $(document).ready(function () {
        $("#txtPhysician").autocomplete({
        source: function (request, response) {
            $.ajax({
                url: '@Url.Action("GetPhysicianLinks", "Staffs")',
                datatype: "json",
                data: {
                    term: request.term
                },
                success: function (data) {
                    response($.map(data, function (item) {
                        return {
                            label: item.label,
                            value: item.val
                        }
                    }))
                }
            })
        },
        select: function (event, ui) {
            showLabel("Linked: " + ui.item.label);
            togglePhysicianLink();
            $("#hfPhysician").val(ui.item.value);
        }
        });

        function showLabel(display) {
            $('#sectionPhysicianLink').text(display);
        }
        });

        
        function togglePhysicianLink() {
            $('@("#LinkPanel" + Model.SectionId + "_Set")').collapse("toggle");
            $('@("#LinkPanel" + Model.SectionId + "_Display")').collapse("toggle");
        }
    </script>

}

