@model PHO_WebApp.Models.Section
@{
    Layout = null;
}
@if (Model.PhysicianLinkType == PHO_WebApp.Models.PhysicianLinkTypeEnum.Allowed
    || Model.PhysicianLinkType == PHO_WebApp.Models.PhysicianLinkTypeEnum.Required)
{
    @* Begin Physician Lookup *@
    <p>
        <i>This section requires a link to an existing physician.</i>
        <strong id="sectionPhysicianLink" style="font-weight:bold"></strong>
    </p>

    <p>
        <a class="btn btn-primary" data-toggle="collapse" href="@("#LinkPanel" + Model.SectionId)" role="button" aria-expanded="false" aria-controls="@("LinkPanel" + Model.SectionId)">Physician Lookup</a>
    </p>
    <div class="row" style="margin-bottom:5px;">
        <div class="col">
            <div class="collapse" id="@("LinkPanel" + Model.SectionId)">
                <div class="card card-body">

                    <div class="input-group">
                        <label for="txtPhysician">Physician Lookup: </label>
                        <input type="text" id="txtPhysician" name="PhysicianName" style="font-style:italic" placeholder="Enter search term here" />
                        <input type="hidden" id="hfPhysician" name="PhysicianId" />
                        @*<div class="input-group-append">
                                <button class="btn btn-secondary" type="button">
                                    <i class="fa fa-search"></i>
                                </button>
                            </div>*@
                    </div>
                </div>
            </div>
        </div>
    </div>
    @*End Physician Lookup*@


    <script>
    $(document).ready(function () {
        $("#txtPhysician").autocomplete({
        source: function (request, response) {
            $.ajax({
                url: '@Url.Action("GetPhysicianLinks", "Staffs")',
                datatype: "json",
                data: {
                    term: request.term
                },
                success: function (data) {
                    response($.map(data, function (item) {
                        return {
                            label: item.label,
                            value: item.val,
                            staffId: item.val
                        }
                    }))
                }
            })
        },
        select: function (event, ui) {
            showLabel(ui.item.label + '');
            hidePhysicianLink();
            $("#hfPhysician").val(ui.item.value);
        }
        });

        function showLabel(display) {
            $('#sectionPhysicianLink').text(display);
        }
        function hidePhysicianLink() {
            $('@("#LinkPanel" + Model.SectionId)').collapse();
        }
});
    </script>

}

