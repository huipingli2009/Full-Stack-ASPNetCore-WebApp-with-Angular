@using PHO_WebApp.Models;
@model PHO_WebApp.Models.SurveyForm
@{
    ViewBag.Title = "Display";
    Layout = "~/Views/Shared/_Layout.cshtml";
    HtmlHelper.ClientValidationEnabled = false;
}

<h2>Survey - @Model.Survey_Title</h2>

@using (Html.BeginForm("Submit", "Survey", FormMethod.Post))
{
    @Html.HiddenFor(m => Model.FormId);
    @Html.HiddenFor(m => Model.FormResponseId);
    @Html.ValidationSummary();

    for (var i = 0; i < Model.FormSections.Count(); i++)
    {
        @Html.EditorFor(model => Model.FormSections[i])
    }

    <input type="submit" name="Save" value="Submit" class="btn btn-primary" />
}

<script type="text/javascript">

    function registerPhysicianLinkAutocomplete(uniqueId) {
        $("#txtPhysician_" + uniqueId).autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetPhysicianLinks", "Staffs")',
                    datatype: "json",
                    data: {
                        term: request.term
                    },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return {
                                label: item.label,
                                value: item.val
                            }
                        }))
                    }
                })
            },
            select: function (event, ui) {
                showPhysicianLinkLabel(uniqueId, 'Linked: ' + ui.item.label);
                togglePhysicianLink(uniqueId);
                $("#PhysicianStaffId_" + uniqueId).val(ui.item.value);
            }
        });
    }

    
    function showPhysicianLinkLabel(uniqueId, display) {
        $('#lblPhysicianLinkDisplay_' + uniqueId).text(display);
    }
    function togglePhysicianLink(uniqueId) {
        $('#PhysicianLinkPanel_' + uniqueId + '_Set').collapse("toggle");
        $('#PhysicianLinkPanel_' + uniqueId + '_Display').collapse("toggle");
    }
</script>


